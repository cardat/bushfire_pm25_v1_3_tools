<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 STL decomposition | Bushfire-specific PM2.5 V1.3 data (Last edited on 2025-07-02)</title>
  <meta name="description" content="8 STL decomposition | Bushfire-specific PM2.5 V1.3 data (Last edited on 2025-07-02)" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="8 STL decomposition | Bushfire-specific PM2.5 V1.3 data (Last edited on 2025-07-02)" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 STL decomposition | Bushfire-specific PM2.5 V1.3 data (Last edited on 2025-07-02)" />
  
  
  

<meta name="author" content="Bushfire Smoke Exposures Team" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="motivation.html"/>
<link rel="next" href="flags.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>I Dataset details</b></span></li>
<li class="chapter" data-level="2" data-path="metadata.html"><a href="metadata.html"><i class="fa fa-check"></i><b>2</b> Metadata</a>
<ul>
<li class="chapter" data-level="2.1" data-path="metadata.html"><a href="metadata.html#component-datasets"><i class="fa fa-check"></i><b>2.1</b> Component datasets</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="metadata.html"><a href="metadata.html#bushfire_specific_pm25_aus_2001_2020_v1_3"><i class="fa fa-check"></i><b>2.1.1</b> Bushfire_specific_PM25_Aus_2001_2020_v1_3</a></li>
<li class="chapter" data-level="2.1.2" data-path="metadata.html"><a href="metadata.html#bushfire_specific_pm25_aus_2020_2023_v1_3"><i class="fa fa-check"></i><b>2.1.2</b> Bushfire_specific_PM25_Aus_2020_2023_v1_3</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="metadata.html"><a href="metadata.html#data-dictionary"><i class="fa fa-check"></i><b>2.2</b> Data dictionary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataset-licencing.html"><a href="dataset-licencing.html"><i class="fa fa-check"></i><b>3</b> Dataset licencing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dataset-licencing.html"><a href="dataset-licencing.html#data-sharing-and-co-authorship-policy"><i class="fa fa-check"></i><b>3.1</b> Data sharing and co-authorship policy</a></li>
<li class="chapter" data-level="3.2" data-path="dataset-licencing.html"><a href="dataset-licencing.html#applying-for-data-access"><i class="fa fa-check"></i><b>3.2</b> Applying for data access</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="methodology.html"><a href="methodology.html"><i class="fa fa-check"></i><b>4</b> Methodology</a>
<ul>
<li class="chapter" data-level="4.1" data-path="methodology.html"><a href="methodology.html#pm2.5-estimation"><i class="fa fa-check"></i><b>4.1</b> PM<sub>2.5</sub> estimation</a></li>
<li class="chapter" data-level="4.2" data-path="methodology.html"><a href="methodology.html#methodology-stl"><i class="fa fa-check"></i><b>4.2</b> Seasonal Decomposition model summary</a></li>
<li class="chapter" data-level="4.3" data-path="methodology.html"><a href="methodology.html#methodology-flags"><i class="fa fa-check"></i><b>4.3</b> Flags</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="caveats.html"><a href="caveats.html"><i class="fa fa-check"></i><b>5</b> Caveats</a>
<ul>
<li class="chapter" data-level="5.1" data-path="caveats.html"><a href="caveats.html#missing-data"><i class="fa fa-check"></i><b>5.1</b> Missing data</a></li>
<li class="chapter" data-level="5.2" data-path="caveats.html"><a href="caveats.html#negative-predicted-pm2.5-values"><i class="fa fa-check"></i><b>5.2</b> Negative predicted PM<sub>2.5</sub> values</a></li>
<li class="chapter" data-level="5.3" data-path="caveats.html"><a href="caveats.html#infilled-data"><i class="fa fa-check"></i><b>5.3</b> Infilled data</a></li>
<li class="chapter" data-level="5.4" data-path="caveats.html"><a href="caveats.html#artefacts"><i class="fa fa-check"></i><b>5.4</b> Artefacts</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="user-guide.html"><a href="user-guide.html"><i class="fa fa-check"></i><b>6</b> User guide</a>
<ul>
<li class="chapter" data-level="6.1" data-path="user-guide.html"><a href="user-guide.html#demo-r-code"><i class="fa fa-check"></i><b>6.1</b> Demo <code>R</code> code</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="user-guide.html"><a href="user-guide.html#read-metadata-with-ncdf4"><i class="fa fa-check"></i><b>6.1.1</b> Read metadata with <code>ncdf4</code></a></li>
<li class="chapter" data-level="6.1.2" data-path="user-guide.html"><a href="user-guide.html#read-data-with-terra"><i class="fa fa-check"></i><b>6.1.2</b> Read data with <code>terra</code></a></li>
<li class="chapter" data-level="6.1.3" data-path="user-guide.html"><a href="user-guide.html#read-data-with-stars"><i class="fa fa-check"></i><b>6.1.3</b> Read data with <code>stars</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="user-guide.html"><a href="user-guide.html#gis-software"><i class="fa fa-check"></i><b>6.2</b> GIS software</a></li>
<li class="chapter" data-level="6.3" data-path="user-guide.html"><a href="user-guide.html#previous-workshops"><i class="fa fa-check"></i><b>6.3</b> Previous workshops</a></li>
</ul></li>
<li class="part"><span><b>II Context</b></span></li>
<li class="chapter" data-level="7" data-path="motivation.html"><a href="motivation.html"><i class="fa fa-check"></i><b>7</b> Motivation</a></li>
<li class="chapter" data-level="8" data-path="stl-decomposition.html"><a href="stl-decomposition.html"><i class="fa fa-check"></i><b>8</b> STL decomposition</a>
<ul>
<li class="chapter" data-level="8.1" data-path="stl-decomposition.html"><a href="stl-decomposition.html#quantification-of-bushfire-specific-pm2.5"><i class="fa fa-check"></i><b>8.1</b> Quantification of bushfire-specific PM<sub>2.5</sub></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="flags.html"><a href="flags.html"><i class="fa fa-check"></i><b>9</b> Flags</a>
<ul>
<li class="chapter" data-level="9.1" data-path="flags.html"><a href="flags.html#usage"><i class="fa fa-check"></i><b>9.1</b> Usage</a></li>
</ul></li>
<li class="part"><span><b>III Case studies</b></span></li>
<li class="chapter" data-level="10" data-path="cart-model.html"><a href="cart-model.html"><i class="fa fa-check"></i><b>10</b> CART model</a></li>
<li class="chapter" data-level="11" data-path="identifying-extreme-pm2.5-events.html"><a href="identifying-extreme-pm2.5-events.html"><i class="fa fa-check"></i><b>11</b> Identifying extreme PM<sub>2.5</sub> events</a></li>
<li class="chapter" data-level="12" data-path="exceptional-pm2.5-events.html"><a href="exceptional-pm2.5-events.html"><i class="fa fa-check"></i><b>12</b> Exceptional PM<sub>2.5</sub> events</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bushfire-specific PM<sub>2.5</sub> V1.3 data (Last edited on 2025-07-02)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="stl-decomposition" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> STL decomposition<a href="stl-decomposition.html#stl-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The three components (Fig. <a href="stl-decomposition.html#fig:method-stl-breakdown">8.1</a>) capture different aspects of the total PM<sub>2.5</sub> timeseries. Long-term variation (over years) is found in <code>trend</code>, which in the case shown, is a slight decrease over 2015. Year-to-year changes in PM<sub>2.5</sub> are typically low (less than 1µg/m<sup>3</sup>) and thus <code>trend</code> does not typically vary significantly. The <code>seasonal</code> component, in contrast, represents regular fluctuations in the timeseries. Here the fluctuations tend to depend on the time of year and the seasonal component is similar (though not exactly the same) for each year. In this example, the higher <code>seasonal</code> PM<sub>2.5</sub> during May to October is a reflection of the regular dry season bushfires in the Northern Territory.</p>
<div class="figure"><span style="display:block;" id="fig:method-stl-breakdown"></span>
<img src="main_images/method-stl-breakdown-1.png" alt="STL components and total PM2.5 concentration for a pixel in Darwin (NT) for the year 2015." width="672" />
<p class="caption">
Figure 8.1: STL components and total PM2.5 concentration for a pixel in Darwin (NT) for the year 2015.
</p>
</div>
<p>The <code>seasonal</code> pattern can vary greatly from one location to another, depending on climate and the surrounding environment. While in Darwin, bushfires are expected in the dry season (winter months), south-eastern Australia typically experiences bushfires in the summer months and would see peaks of <code>seasonal</code> PM<sub>2.5</sub> through December to February, as in Campbelltown (NSW). High <code>seasonal</code> PM<sub>2.5</sub> is also not necessarily indicative of bushfires. For instance, Launceston (Tasmania) experiences high <code>seasonal</code> PM<sub>2.5</sub> through winter months, not due to bushfires but rather domestic wood heater smoke (Fig. <a href="stl-decomposition.html#fig:method-stl-seasonal-comparison">8.2</a>).</p>
<div class="figure"><span style="display:block;" id="fig:method-stl-seasonal-comparison"></span>
<img src="main_images/method-stl-seasonal-comparison-1.png" alt="Comparison of seasonal components for locations of contrasting environment and climate around Australia - Darwin (NT), Campbelltown (NSW) and Launceston (Tasmania)." width="672" />
<p class="caption">
Figure 8.2: Comparison of seasonal components for locations of contrasting environment and climate around Australia - Darwin (NT), Campbelltown (NSW) and Launceston (Tasmania).
</p>
</div>
<p>Together, the <code>trend</code> and <code>seasonal</code> components are a expectation of the PM<sub>2.5</sub> concentration given the long-term and seasonal variations. The <code>remainder</code> is therefore represents the fluctuations around the expected value.</p>
<div class="figure"><span style="display:block;" id="fig:method-stl-cumulative"></span>
<img src="main_images/method-stl-cumulative-1.gif" alt="Cumulative addition of STL components to total PM2.5 concentration for pixel in Darwin (NT) for the year 2015."  />
<p class="caption">
Figure 8.3: Cumulative addition of STL components to total PM2.5 concentration for pixel in Darwin (NT) for the year 2015.
</p>
</div>
<p>The three STL components sum to the total PM<sub>2.5</sub>, illustrated in Figure <a href="stl-decomposition.html#fig:method-stl-cumulative">8.3</a>. Note that both the <code>seasonal</code> and <code>remainder</code> components are often negative - the <code>seasonal</code> component captures regular variations around the long-term <code>trend</code> and the <code>remainder</code> component the fluctuations around ‘expectation’, <code>trend + seasonal</code>.</p>
<div id="quantification-of-bushfire-specific-pm2.5" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Quantification of bushfire-specific PM<sub>2.5</sub><a href="stl-decomposition.html#quantification-of-bushfire-specific-pm2.5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is important to note that the STL alone does not indicate the presence of bushfire smoke-related PM<sub>2.5</sub>. Additional information such as the flags are required to classify days as being bushfire-affected or not.</p>
<p>The STL decomposition does allow a degree of quantification of bushfire-specific PM<sub>2.5</sub> once those bushfire-affected days are identified. Different approaches are possible and the best option will depend on the study question.</p>
<p>Taking, for instance, the Darwin example above (Fig. <a href="stl-decomposition.html#fig:method-stl-breakdown">8.1</a>), the <code>seasonal</code> component includes the expected regular bushfire-related PM<sub>2.5</sub> during the dry season. Increased <code>remainder</code> indicates a worse-than-usual bushfire-affected day (higher PM<sub>2.5</sub>) and conversely decreased <code>remainder</code> shows this day was less affected than usual or not affected at all.</p>
<p>Thus the difference between <code>remainder</code> and <code>seasonal + trend</code> (expectation) for a bushfire-affected day (assuming bushfires to be the dominant source of PM<sub>2.5</sub>) is only a partial representation of the full PM<sub>2.5</sub> due to bushfires. This may be a reasonable measure if the study is concerned with exceptionally poor air quality due to bushfire events of greater than usual severity.</p>
<p>An alternative approach is to identify a bushfire-affected day then assume all PM<sub>2.5</sub> above some background level to be attributable to bushfire smoke. This is a more inclusive approach but could overestimate if there are other significant sources of PM<sub>2.5</sub> on those days. Furthermore, what is regarded as background is not clearly defined (e.g. could be the <code>trend</code> value, an arbitrary set value, or a statistical threshold value such as the annual mean). Again, this should be considered with respect to the study question.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="motivation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="flags.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
