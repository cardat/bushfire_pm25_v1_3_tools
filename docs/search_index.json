[["index.html", "Bushfire-specific PM2.5 V1.3 data (Last edited on 2025-07-02) 1 Overview Acknowledgements", " Bushfire-specific PM2.5 V1.3 data (Last edited on 2025-07-02) Bushfire Smoke Exposures Team 1 Overview The Bushfire-specific PM2.5 V1.3 datasets are a set of daily time-series rasters of estimated total PM2.5 concentration covering Australia (Fig. 1.1). These additionally include a seasonal-trend decomposition using LOESS (STL) of the total PM2.5 into seasonal, trend and remainder components (Figure 1.2), as well as a series of binary flags. Both the decomposed PM2.5 components and flags may be used in identification and quantification of bushfire-related PM2.5 exposures. The original dataset accompanies the following publication: Borchers-Arriagada, N., Morgan, G.G., Buskirk, J.V., Gopi, K., Yuen, C., Johnston, F.H., Guo, Y., Cope, M. and Hanigan, I.C. (2024) ‘Daily PM2.5 and Seasonal-Trend Decomposition to Identify Extreme Air Pollution Events from 2001 to 2020 for Continental Australia Using a Random Forest Model’, Atmosphere, 15(1341). Available at: https://doi.org/10.3390/atmos15111341. Figure 1.1: Raster map of total PM2.5 (µg/m3) for Australia on 2013-10-18. Lithgow (NSW) is marked with a red diamond, corresponding to the location of the STL decomposition shown below. Figure 1.2: STL decomposition of total PM2.5 (µg/m3) into trend, seasonal and remainder components for the pixel at Lithgow (NSW). Dotted red line indicates the date 2013-10-18, corresponding to the above raster map. This location was affected by the nearby State Mine bushfire. (Note the scale for y axis is not fixed.) Read more about the dataset and its development in the Metadata and Methodology. The dataset is available on request for research purposes. It is managed by the Clean Air Research Data and Analysis Technology (CARDAT) team of the Centre for Safe Air (CSA). Please read the full data sharing policy and submit an access request through the CARDAT Data Access Form. Acknowledgements The development of the Bushfire-specific PM2.5 2001-2020 V1.3 dataset was funded by the Australian Research Data Commons (ARDC), as part of the Bushfire Data Challenges - Assessing the impact of bushfire smoke on health project. We acknowledge the Sydney Informatics Hub and the University of Sydney’s high performance computing cluster Artemis for providing the high performance computing resources on which the Bushfire-specific PM2.5 V1.3 datasets were generated. We would also like to thank Dana Jordan for her assistance during the QA/QC process. "],["metadata.html", "2 Metadata 2.1 Component datasets 2.2 Data dictionary", " 2 Metadata These datasets consists of daily PM2.5 predictions across Australia using the revised random forest model of the Bushfire Smoke project V1.3. It corrects the input predictors of and supersedes V1.2. Data is provided in NetCDF format in the data_derived/ directory of each dataset folder. Spatial resolution and extent of the raster is a 5km grid across Australia (mainland and Tasmania) in GDA94 / Australian Albers projection (EPSG:3577). Variables consist of: daily estimated total PM2.5 (µg/m3) from the random forest model STL decomposition components of total PM2.5 Daily firesmoke flags for indication of bushfire events (for the original 2001-2020 dataset only) Further description of the methodology can be found in the section Methodology. 2.1 Component datasets 2.1.1 Bushfire_specific_PM25_Aus_2001_2020_v1_3 This is the original dataset as described in the published paper and covers days from 2001-01-01 to 2020-06-30. The random forest model was trained on observed daily data from regulatory monitors then used to predict over the 5km grid. The total PM2.5 predictions were then broken down into trend, seasonal and remainder components for each pixel through STL decomposition over 2001-2019 (see Methodology - STL decomposition), excluding 2020 due to the exceptional bushfire events of 2019-2020. STL components for 2020 were filled by assuming identical daily seasonal and trend components for 2019 and 2020, calculating the 2020 remainder component as the difference between total PM2.5 (2020) and seasonal + trend (2019). Statistical thresholds for extreme PM2.5 were calculated for each pixel—both the 95th percentile of predicted PM2.5 and standard deviation of the trimmed (to 99th percentile) remainder. Binary flags for identification of bushfire events were then produced from the statistical thresholds and other external data sources (see Table 2.2 for full listing of flags): active fire MODIS product PM2.5 dust from MERRA-2 reanalysis dust AOD from CAMS reanalysis temperature from Bureau of Meteorology’s AWAP grids Daily predicted PM2.5, STL components and binary flags are stored as a NetCDF file by year in the data_derived/ directory. The calculated statistical thresholds are stored in data_derived_raw_flags/, also as NetCDFs. Note each threshold is a single layer (no time component) as both have been calculated across all years 2001-2020. 2.1.2 Bushfire_specific_PM25_Aus_2020_2023_v1_3 The 2020-2023 update uses the original random model (trained on 2001-2020 data) to predict daily PM2.5 from 2020-01-01 to 2023-12-31. STL decomposition was performed with only 2021-2023 data, omitting 2020 data as in the original dataset. 2020 STL components were infilled by assuming identical trend and seasonal components as 2021, and taking the difference between total PM2.5 (2020) and seasonal + trend (2021) to be the remainder component. Consequently the STL components for the overlapping period of the two datasets (2020-01-01 to 2020-06-30) are not identical. There may also be visible discontinuity of STL components between the original 2001-2020 and 2020-2023 update. Both predicted PM2.5 and STL components are available in the data_derived/ folder as NetCDF files by year. Statistical thresholds and other flags were not produced. 2.2 Data dictionary Table 2.1: Description of non-firesmoke flag variables available for both 2001-2020 and 2020-2023 datasets. Variable Description pm25_pred Total predicted PM2.5 (µg/m3) seasonal Seasonal component of PM2.5 STL decomposition (µg/m3) trend Trend component of PM2.5 STL decomposition (µg/m3) remainder Remainder component of PM2.5 STL decomposition (µg/m3) extrapolated Flag indicating if raster value for flag variables were spatially extrapolated (1 if True, 0 if False) prediction_out_range Flag indicating if pm25_pred value was beyond the range of PM2.5 used to train model (1 if True, 0 if False) predictor_out_range Number of predictors which had a value beyond the range of that used to train the model Table 2.2: Description of firesmoke flags for V1.3, produced for 2001-2020. Timepoints are daily from 2001 to 2020. Flag Description dust_cams_p50 1 if CAMS AOD dust for pixel-timepoint &gt; 50th percentile of CAMS AOD dust (all pixels and timepoints), otherwise 0 dust_cams_p75 1 if CAMS AOD dust for pixel-timepoint &gt; 75th percentile of CAMS AOD dust (all pixels and timepoints), otherwise 0 dust_cams_p95 1 if CAMS AOD dust for pixel-timepoint &gt; 95th percentile of CAMS AOD dust (all pixels and timepoints), otherwise 0 dust_merra_2_p50 1 if MERRA-2 PM2.5 dust for pixel-timepoint &gt; 50th percentile of MERRA-2 PM2.5 dust (all pixels and timepoints), otherwise 0 dust_merra_2_p75 1 if MERRA-2 PM2.5 dust for pixel-timepoint &gt; 75th percentile of MERRA-2 PM2.5 dust (all pixels and timepoints), otherwise 0 dust_merra_2_p95 1 if MERRA-2 PM2.5 dust for pixel-timepoint &gt; 95th percentile of MERRA-2 PM2.5 dust (all pixels and timepoints), otherwise 0 smoke_p95_v1_3 1 if daily predicted PM2.5 for pixel-timepoint &gt; 95th percentile of daily PM2.5 of pixel (all timepoints), otherwise 0 trimmed_smoke_2SD_v1_3 1 if remainder for pixel-timepoint &gt; 2 standard deviations (SD) of the trimmed remainder (excluded values above 99th percentile) of pixel (all timepoints), otherwise 0 whs_18degreeC 1 if mean daily temperature for pixel-timepoint &lt; 18°C, otherwise 0 whs_15degreeC 1 if mean daily temperature for pixel-timepoint &lt; 15°C, otherwise 0 whs_12degreeC 1 if mean daily temperature for pixel-timepoint &lt; 12°C, otherwise 0 active_fires_10000 1 if active fires present for pixel-timepoint within 10km buffer, otherwise 0 active_fires_25000 1 if active fires present for pixel-timepoint within 25km buffer, otherwise 0 active_fires_50000 1 if active fires present for pixel-timepoint within 50km buffer, otherwise 0 active_fires_100000 1 if active fires present for pixel-timepoint within 100km buffer, otherwise 0 active_fires_500000 1 if active fires present for pixel-timepoint within 500km buffer, otherwise 0 "],["dataset-licencing.html", "3 Dataset licencing 3.1 Data sharing and co-authorship policy 3.2 Applying for data access", " 3 Dataset licencing 3.1 Data sharing and co-authorship policy Our dataset represents a valuable resource for advancing public health knowledge, and we are committed to supporting high-quality research while ensuring proper recognition of our work. To this end, we have established the following policy for data sharing and potential co-authorship. Researchers interested in utilising our dataset are required to submit a proposal using our provided template. This proposal should outline the intended research, including a summary of the study objectives, the planned use of our data, and any publication intentions. We particularly encourage researchers to articulate how they plan to frame their findings from a public health perspective. This proposal process serves dual purposes: it allows us to maintain comprehensive records of data usage and potential research outputs, and it provides an opportunity for initial dialogue about the proposed work. Upon receiving a proposal, our team will review the submitted information and, if appropriate, grant approval for the specific purposes outlined. It’s important to note that if there are any significant changes to the proposed research after approval, an amended proposal must be submitted for our consideration. Acknowledgement of our dataset, using our provided text and DOI, is mandatory in any resulting publications. Beyond this basic recognition, we encourage deeper collaboration and co-authorship opportunities. An offer of co-authorship with the first and last author of the data for any publication of research utilising the data is expected. These will be evaluated based on the level of contribution of our team, following the guidelines set forth by the International Committee of Medical Journal Editors (ICMJE). Regarding co-authorship, we typically extend invitations to the first and last authors of our dataset paper but in some instances other authors of the data may be invited. These individuals may choose to accept or decline the offer of co-authorship based on their level of involvement and the ICMJE criteria for authorship. This approach ensures that co-authorship accurately reflects substantial contributions to the new research while recognising the foundational work of our dataset. We believe in maintaining open lines of communication throughout the research process. While we may not have the capacity for individual meetings with all researchers, we remain available for consultation as needed. This could involve providing methodological advice, assisting with result interpretation, or offering guidance on formulating impactful public health messages. However, it’s important to note that our team reserves the right to decline co-authorship if we don’t have time, or feel our contributions do not meet the established ICMJE criteria. Before granting access to the dataset, we require researchers to agree to these terms in writing. This agreement will specify the approved use of the data as per the submitted proposal, acknowledgement requirements, the process for determining co-authorship, and any other relevant conditions. For researchers who are co-authors of the dataset, we’re open to discussing alternative arrangements. These might include citation of the dataset or inclusion of the first and last author in the co-authorship agreement depending on the nature of the proposed work and level of additional contribution required. Through this policy, we aim to strike a balance between promoting valuable research and maintaining the integrity of our data and the contributions of our team. We’re committed to supporting work that advances public health knowledge while ensuring fair and appropriate attribution of scientific contributions. By providing clear guidelines on data usage, acknowledgement, and potential co-authorship, we hope to foster productive collaborations and impactful research outcomes. 3.2 Applying for data access Data access requests can be submitted through the CARDAT Data Access Form, specifying the dataset (Bushfire_specific_PM25_Aus_2001_2020_v1_3, Bushfire_specific_PM25_Aus_2020_2023_v1_3, or both) requested. Please provide a reasonable description of your intended use of the data in accordance with clause (1) above, and understand the expectations regarding acknowledgement (clause (3)) and co-authorship (clause (4)). Note that these data are otherwise restricted and may not be on-shared or used for any purposes beyond that described in your request without explicit permission. "],["methodology.html", "4 Methodology 4.1 PM2.5 estimation 4.2 Seasonal Decomposition model summary 4.3 Flags", " 4 Methodology A summarised methodology is outlined below. The full description of methodology can be found in the following publication: Borchers-Arriagada, N., Morgan, G.G., Buskirk, J.V., Gopi, K., Yuen, C., Johnston, F.H., Guo, Y., Cope, M. and Hanigan, I.C. (2024) ‘Daily PM2.5 and Seasonal-Trend Decomposition to Identify Extreme Air Pollution Events from 2001 to 2020 for Continental Australia Using a Random Forest Model’, Atmosphere, 15(1341). Available at: https://doi.org/10.3390/atmos15111341. 4.1 PM2.5 estimation A random forest model for the estimation of total PM2.5 concentration was developed on a range of satellite-derived, land use, land cover, road and traffic, and weather and climate predictors. The response variable PM2.5 was drawn from state and territory government monitor observations, aggregated from hourly to daily level. Predictors were first filtered to exclude highly correlated variables (&gt;80%). A grid search of hyperparameters was performed and, for the optimal set of hyperparameters, the variables of importance were selected (variables with importance higher than the mean). The final random forest model was then trained on these selected variables with default hyperparameter settings and used to estimate PM2.5 for a 5km resolution grid of Australia (mainland and Tasmania). 4.2 Seasonal Decomposition model summary Decomposition of the predicted PM2.5 was performed using Seasonal and Trend Decomposition using LOESS (STL), splitting the total PM2.5 into trend, seasonal and remainder components. The STL was calculated considering each grid point as a time series starting in 2001, imputing missing values with imputeTS::na_interpolation. A grid search of the seasonal window parameter of the STL was performed (values = 15, 25, 35, 45) and partial autocorrelation calculated of the STL using stats::pacf. Very slight differences were observed in the partial autocorrelation when comparing seasonal windows. A seasonal window of 45 was selected on the basis of having the lowest maximum partial autocorrelation. It was also noted the higher value for seasonal window produced a more regular variation in seasonal component. Due to the extraordinary bushfire events and resulting PM2.5 levels in January 2020, the STL decomposition did not include data from 2020 year. Decomposition of PM2.5 for 2020 was instead infilled by assuming identical daily seasonal and trend components to 2019 (for the 2001-2020 original dataset) or 2021 (for the 2020-2023 update). The remainder component for 2020 was then calculated as the difference between the estimated total PM2.5 and assumed trend + seasonal component. 4.3 Flags For each pixel, a series of binary flags to aid identification of PM2.5 source were extracted from a variety of satellite data and weather grids. Additionally two statistical threshold flags were calculated from the estimated PM2.5 and the STL remainder component as an indication of unusually high levels of PM2.5. Dust data was drawn from two sources - CAMS satellite aerosol optical depth (AOD) and MERRA-2 PM2.5 dust - and pixel flagged if it exceeded a specific percentile threshold calculated over the entire time period (2001-2020) and all pixels. In a similar manner, the temperature flags were set to indicate where the pixel had a mean daily temperature below a specific temperature. Pixels were flagged for active fires (from satellite-derived data) for a given buffer size (ranging from 10km to 500km) if an active fire was present within the buffer of a pixel. A statistical threshold was calculated from the total PM2.5 concentration by determining the 95th percentile of PM2.5 over the study time period for each pixel. The pixel was then flagged for each day where PM2.5 exceeded this threshold. A second statistical threshold was derived by trimming the remainder component to the 99th percentile then calculating the standard deviation (SD) for each pixel. The pixel was then flagged if the remainder exceeded 2 \\(\\times\\) SD of the trimmed remainder. "],["caveats.html", "5 Caveats 5.1 Missing data 5.2 Negative predicted PM2.5 values 5.3 Infilled data 5.4 Artefacts", " 5 Caveats 5.1 Missing data Due to the unavailability of solar exposure data, there are several missing days of prediction prior to 2010. Solar exposure data and predicted PM2.5 is complete from 2010 onwards. Dust flags derived from the CAMS are not available pre-2003. Due to unavailability of landscape fire data before November 2020 (the basis of active_fire predictors), PM2.5 could not be estimated for years pre-2001. 5.2 Negative predicted PM2.5 values PM2.5 predictions are occasionally negative. This could be a consequence of the training data, which allowed negative values in the response variable. It may also be a result of the application of the model to environments dissimilar to the locations in the training data. Most regulatory monitors are located in urban areas and/or close to human infrastructure, and therefore the model may be less accurate in rural or unpopulated regions. The prediction_out_range variable indicates where the predicted PM2.5 fall outside the range of the response variable values provided to train the model. There are a variety of methods to handle negative values: consider using prediction_out_range or a conditional on the PM2.5 value to identify improbable values consider removing negative or improbable values (interpolating to fill missing values if needed) or truncating to some chosen threshold threshold may be absolute (specific value) or relative (e.g. percentile) 5.3 Infilled data Raster cells along water bodies were not well-covered by some predictors and consequently the model could not estimate a PM2.5 concentration at those points. This was a result of the predictor extraction process, where data was extracted by point extraction (using the prediction grid cell centroid) from the source predictor raster. For some predictors, the source raster was missing over water bodies and thus would return NA if the prediction grid cell centroid lay slightly offshore (though the cell might otherwise include significant land area). As much of Australia’s population is concentrated along coastal regions, the dataset was extrapolated to ensure all missing coastal pixels were filled. Extrapolation was performed for missing coastal pixels by: calculating a focal window (size 3, queen-type contiguity) maximum on the binary flags (i.e. if any adjacent cell is flagged, the target cell is also flagged); and calculating a focal window (size 3) mean on the PM2.5 prediction and decomposition components (i.e. mean of all non-NA adjacent cells) Additionally, flags were originally extracted for the superseded V1.2 grid and were remapped to the V1.3 grid, rather than performing a full extraction for the V1.3 grid. As the V1.2 grid did not entirely cover the V1.3 grid, flags were extrapolated by taking a 15km buffer on unmapped grid points and setting the flag to 1 if any V1.2 grid cell within the buffer was flagged 1. 5.4 Artefacts PM2.5 was predicted on a grid of 5km resolution, however the predictions may not vary smoothly across the entirety of the extent due to the limited resolution of input predictors. This is sometimes noticeable in visualisations of the surface: grid pattern of roughly 55km width and height, matching the MERRA-2 satellite raster grid resolution circular regions (particular in northern Australia) corresponding to the 100km radius buffers of the em_fire_dens_fireskm2_100000_daily predictor seemingly random small ‘patches’ in fixed positions across daily predictions, corresponding to the predictor pop_dens_10000 "],["user-guide.html", "6 User guide 6.1 Demo R code 6.2 GIS software 6.3 Previous workshops", " 6 User guide 6.1 Demo R code 6.1.1 Read metadata with ncdf4 To read metadata from the NetCDF, use the ncdf4 package. library(ncdf4) # select file infile &lt;- &quot;Bushfire_specific_PM25_Aus_2001_2020_v1_3/data_derived/bushfiresmoke_v1_3_2003_compressed_20231130_7.nc&quot; ## read netCDF nc &lt;- ncdf4::nc_open(infile) # nc # show summary overview ## show variable names names(nc$var) ## [1] &quot;albers_conical_equal_area&quot; &quot;prediction_out_range&quot; ## [3] &quot;predictor_out_range&quot; &quot;active_fires_10000&quot; ## [5] &quot;active_fires_100000&quot; &quot;active_fires_25000&quot; ## [7] &quot;active_fires_50000&quot; &quot;active_fires_500000&quot; ## [9] &quot;dust_cams_p50&quot; &quot;dust_cams_p75&quot; ## [11] &quot;dust_cams_p95&quot; &quot;dust_merra_2_p50&quot; ## [13] &quot;dust_merra_2_p75&quot; &quot;dust_merra_2_p95&quot; ## [15] &quot;extrapolated&quot; &quot;whs_12degreeC&quot; ## [17] &quot;whs_15degreeC&quot; &quot;whs_18degreeC&quot; ## [19] &quot;smoke_p95_v1_3&quot; &quot;trimmed_smoke_2SD_v1_3&quot; ## [21] &quot;pm25_pred&quot; &quot;remainder&quot; ## [23] &quot;seasonal&quot; &quot;trend&quot; ## show global attributes names(ncatt_get(nc, 0)) ## [1] &quot;CDI&quot; &quot;Conventions&quot; &quot;history&quot; &quot;NCO&quot; &quot;CDO&quot; ## [6] &quot;source&quot; &quot;references&quot; &quot;comment&quot; # ncatt_get(nc, 0, &quot;comment&quot;) # read selected global attribute 6.1.2 Read data with terra The terra package can read and manipulate both raster data (as provided here) and vector data. See full documentation for more. library(terra) # select file infile &lt;- &quot;Bushfire_specific_PM25_Aus_2001_2020_v1_3/data_derived/bushfiresmoke_v1_3_2003_compressed_20231130_7.nc&quot; # Read NetCDF sdset &lt;- sds(infile) sdset # show summary of NetCDF contents ## class : SpatRasterDataset ## subdatasets : 23 ## dimensions : 769, 804 (nrow, ncol) ## nlyr : 365, 365, 365, 365, 365, 365, 365, 365, 365 ## resolution : 5000, 5000 (x, y) ## extent : -1892186, 2127815, -4851639, -1006640 (xmin, xmax, ymin, ymax) ## coord. ref. : GDA94 / Australian Albers (EPSG:3577) ## source(s) : bushfiresmoke_v1_3_2003_compressed_20231130_7.nc ## names : prediction_out_range, predictor_out_range, active_fires_10000, active_fires_100000, active_fires_25000, active_fires_50000, ... names(sdset) # show layers/variables ## [1] &quot;prediction_out_range&quot; &quot;predictor_out_range&quot; &quot;active_fires_10000&quot; ## [4] &quot;active_fires_100000&quot; &quot;active_fires_25000&quot; &quot;active_fires_50000&quot; ## [7] &quot;active_fires_500000&quot; &quot;dust_cams_p50&quot; &quot;dust_cams_p75&quot; ## [10] &quot;dust_cams_p95&quot; &quot;dust_merra_2_p50&quot; &quot;dust_merra_2_p75&quot; ## [13] &quot;dust_merra_2_p95&quot; &quot;extrapolated&quot; &quot;whs_12degreeC&quot; ## [16] &quot;whs_15degreeC&quot; &quot;whs_18degreeC&quot; &quot;smoke_p95_v1_3&quot; ## [19] &quot;trimmed_smoke_2SD_v1_3&quot; &quot;pm25_pred&quot; &quot;remainder&quot; ## [22] &quot;seasonal&quot; &quot;trend&quot; # Look at specific layer/variable raster r &lt;- sdset[[&quot;pm25_pred&quot;]] # time(r) # time component of raster # values(r) # values of raster as a matrix r # show summary of raster ## class : SpatRaster ## size : 769, 804, 365 (nrow, ncol, nlyr) ## resolution : 5000, 5000 (x, y) ## extent : -1892186, 2127815, -4851639, -1006640 (xmin, xmax, ymin, ymax) ## coord. ref. : GDA94 / Australian Albers (EPSG:3577) ## source : bushfiresmoke_v1_3_2003_compressed_20231130_7.nc:pm25_pred ## varname : pm25_pred ## names : pm25_pred_1, pm25_pred_2, pm25_pred_3, pm25_pred_4, pm25_pred_5, pm25_pred_6, ... ## time (days) : 2003-01-01 to 2003-12-31 (365 steps) Plots and further geospatial processing may be performed with terra: library(data.table) # Read STL components and extract at a location # set location v &lt;- vect(matrix(c(150.994659, -33.921600), nrow = 1), crs = &quot;epsg:4326&quot;) lyrs &lt;- c(&quot;trend&quot;, &quot;seasonal&quot;, &quot;remainder&quot;, &quot;pm25_pred&quot;) # extract timeseries for each variable extract_ts &lt;- lapply(lyrs, function(x) { r &lt;- sdset[[x]] # read raster variable e &lt;- extract(r, project(v, r)) # extract at given locations setDT(e) e &lt;- melt(e, id.vars = &quot;ID&quot;, variable.factor = F) # reshape to long e$date &lt;- time(r) # add date column e$variable &lt;- x # overwrite variable column with sensible name return(e) }) dat_ts &lt;- rbindlist(extract_ts) # bind all extracted variables into single table str(dat_ts) ## Classes &#39;data.table&#39; and &#39;data.frame&#39;: 1460 obs. of 4 variables: ## $ ID : num 1 1 1 1 1 1 1 1 1 1 ... ## $ variable: chr &quot;trend&quot; &quot;trend&quot; &quot;trend&quot; &quot;trend&quot; ... ## $ value : num 8.6 8.6 8.6 8.6 8.6 ... ## $ date : Date, format: &quot;2003-01-01&quot; &quot;2003-01-02&quot; ... ## - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt; par(mfrow = c(2,2)) plot(dat_ts[dat_ts$variable == &quot;pm25_pred&quot;, .(date, value)], col = &quot;black&quot;, type = &quot;l&quot;, main = &quot;Total PM2.5 (µg/m3)&quot;) plot(dat_ts[dat_ts$variable == &quot;trend&quot;, .(date, value)], type = &quot;l&quot;, main = &quot;PM2.5 (trend component) (µg/m3)&quot;) plot(dat_ts[dat_ts$variable == &quot;seasonal&quot;, .(date, value)], type = &quot;l&quot;, main = &quot;PM2.5 (seasonal component) (µg/m3)&quot;) plot(dat_ts[dat_ts$variable == &quot;remainder&quot;, .(date, value)], type = &quot;l&quot;, main = &quot;PM2.5 (remainder component) (µg/m3)&quot;) 6.1.3 Read data with stars The stars package is intended to handle raster data only. Vector geospatial data can be read by terra or sf instead. Consult the documentation for stars, particularly the article on reading NetCDFs. library(stars) stars_nc.proxy &lt;- stars::read_ncdf(infile, proxy = TRUE) # read whole file as proxy stars_nc.proxy # view summary ## netcdf source stars proxy object from: ## [1] &quot;[...]/bushfiresmoke_v1_3_2003_compressed_20231130_7.nc&quot; ## ## Available nc variables: ## prediction_out_range ## predictor_out_range ## active_fires_10000 ## active_fires_100000 ## active_fires_25000 ## active_fires_50000 ## active_fires_500000 ## dust_cams_p50 ## dust_cams_p75 ## dust_cams_p95 ## dust_merra_2_p50 ## dust_merra_2_p75 ## dust_merra_2_p95 ## extrapolated ## whs_12degreeC ## whs_15degreeC ## whs_18degreeC ## smoke_p95_v1_3 ## trimmed_smoke_2SD_v1_3 ## pm25_pred ## remainder ## seasonal ## trend ## ## dimension(s): ## from to offset delta refsys ## x 1 804 NA NA +proj=aea +lat_1=-18 +lat... ## y 1 769 NA NA +proj=aea +lat_1=-18 +lat... ## time 1 365 2003-01-01 UTC 1 days POSIXct ## values x/y ## x [804] -1889686,...,2125315 [x] ## y [769] -4849140,...,-1009140 [y] ## time NULL ## Read PM2.5 only and subset by x,y,time dimensions # read all x and y, read 7 days from 182nd day of year stars_nc &lt;- stars::read_ncdf(infile, var = &quot;pm25_pred&quot;, ncsub = cbind(start = c(1, 1, 182), count = c(NA, NA, 7))) # visualise plot(stars_nc, breaks = &quot;quantile&quot;, col = RColorBrewer::brewer.pal(9, &quot;Reds&quot;)) 6.2 GIS software NetCDFs may be visualised interactively and manipulated in QGIS (free and open-source) or ArcGIS (proprietary). 6.3 Previous workshops Hacky Hour: Bushfire Smoke V1.3 PM2.5 data and coding with generative AI Code repository: https://github.com/cardat/DatSciTrain_bushfire_specific_pm25_for_locations_2019 Video recording: https://youtu.be/A4PRnbsQT6U "],["motivation.html", "7 Motivation", " 7 Motivation Particulate matter less than 2.5µm in diameter (PM2.5) is an air pollutant known to be harmful to human health even at low concentrations. Due to the size, particles can lodge deep within the lungs and pass into blood, affecting respiratory and cardiovascular systems. The risks associated with PM2.5 exposure are reflected in the most recent WHO guidelines. These guidelines, released in 2021, set a series of interim targets of decreasing PM2.5 concentrations and an end target annual average not exceeding 5µg/m3. While there are multiple contributors to PM2.5 pollution (such as industrial emissions, dust, wood heater smoke), bushfires in particular are a major source of PM2.5 in Australia, ranging from controlled hazard reduction burns to the extraordinary bushfire season of 2019-2020. Health effects from the PM2.5 produced from such burns (as opposed to non-bushfire PM2.5) are not well-researched, in part due to limited data availability of bushfire-specific PM2.5. This dataset provides a prediction of total PM2.5 concentration and flags to estimate the bushfire-specific portion, covering Australia from January 2001 to June 2020 with an update for January 2020 to December 2023. In conjunction with health data, it may be used to elucidate the health burden and impacts due to bushfire smoke PM2.5 and plan for the mitigation of health effects in the future, particularly with increasing threat of unusually severe bushfire events. "],["stl-decomposition.html", "8 STL decomposition 8.1 Quantification of bushfire-specific PM2.5", " 8 STL decomposition The three components (Fig. 8.1) capture different aspects of the total PM2.5 timeseries. Long-term variation (over years) is found in trend, which in the case shown, is a slight decrease over 2015. Year-to-year changes in PM2.5 are typically low (less than 1µg/m3) and thus trend does not typically vary significantly. The seasonal component, in contrast, represents regular fluctuations in the timeseries. Here the fluctuations tend to depend on the time of year and the seasonal component is similar (though not exactly the same) for each year. In this example, the higher seasonal PM2.5 during May to October is a reflection of the regular dry season bushfires in the Northern Territory. Figure 8.1: STL components and total PM2.5 concentration for a pixel in Darwin (NT) for the year 2015. The seasonal pattern can vary greatly from one location to another, depending on climate and the surrounding environment. While in Darwin, bushfires are expected in the dry season (winter months), south-eastern Australia typically experiences bushfires in the summer months and would see peaks of seasonal PM2.5 through December to February, as in Campbelltown (NSW). High seasonal PM2.5 is also not necessarily indicative of bushfires. For instance, Launceston (Tasmania) experiences high seasonal PM2.5 through winter months, not due to bushfires but rather domestic wood heater smoke (Fig. 8.2). Figure 8.2: Comparison of seasonal components for locations of contrasting environment and climate around Australia - Darwin (NT), Campbelltown (NSW) and Launceston (Tasmania). Together, the trend and seasonal components are a expectation of the PM2.5 concentration given the long-term and seasonal variations. The remainder is therefore represents the fluctuations around the expected value. Figure 8.3: Cumulative addition of STL components to total PM2.5 concentration for pixel in Darwin (NT) for the year 2015. The three STL components sum to the total PM2.5, illustrated in Figure 8.3. Note that both the seasonal and remainder components are often negative - the seasonal component captures regular variations around the long-term trend and the remainder component the fluctuations around ‘expectation’, trend + seasonal. 8.1 Quantification of bushfire-specific PM2.5 It is important to note that the STL alone does not indicate the presence of bushfire smoke-related PM2.5. Additional information such as the flags are required to classify days as being bushfire-affected or not. The STL decomposition does allow a degree of quantification of bushfire-specific PM2.5 once those bushfire-affected days are identified. Different approaches are possible and the best option will depend on the study question. Taking, for instance, the Darwin example above (Fig. 8.1), the seasonal component includes the expected regular bushfire-related PM2.5 during the dry season. Increased remainder indicates a worse-than-usual bushfire-affected day (higher PM2.5) and conversely decreased remainder shows this day was less affected than usual or not affected at all. Thus the difference between remainder and seasonal + trend (expectation) for a bushfire-affected day (assuming bushfires to be the dominant source of PM2.5) is only a partial representation of the full PM2.5 due to bushfires. This may be a reasonable measure if the study is concerned with exceptionally poor air quality due to bushfire events of greater than usual severity. An alternative approach is to identify a bushfire-affected day then assume all PM2.5 above some background level to be attributable to bushfire smoke. This is a more inclusive approach but could overestimate if there are other significant sources of PM2.5 on those days. Furthermore, what is regarded as background is not clearly defined (e.g. could be the trend value, an arbitrary set value, or a statistical threshold value such as the annual mean). Again, this should be considered with respect to the study question. "],["flags.html", "9 Flags 9.1 Usage", " 9 Flags The absolute PM2.5 and STL decomposition remainder (see STL decomposition) may be used to determine when PM2.5 concentrations are higher than is typical. However, this does not differentiate between sources, of which bushfires, dust and wood heater smoke are major contributors in Australia. The calculated flags may be used to aid in differentiating days of high PM2.5 due to bushfires and those due to other sources. Some combination of the flags can provide an indication of whether that particular day’s PM2.5 is likely due to firesmoke. There is no definitive rule on which combination should be used. Rather, the choice should be guided by the study question and scope. The user should also consider using any additional data available in their study region to compare with or validate the predictions of bushfire-specific smoke. 9.1 Usage Active fires This flag indicates the presence of an active fire within a given distance of the pixel (10, 25, 50, 100 or 500km). Note the active fires are derived from satellite data and therefore may be less reliable under less ideal conditions such as cloud-covered days. The presence of active fires in close proximity is not a definitive indication that PM2.5 is primarily due to fire smoke as the flag does not indicate intensity nor account for wind direction. It is possible for a pixel to have low bushfire-specific PM2.5 even with an active fire nearby if the wind direction directs smoke away from that location, or if the active fire is of low intensity. Dust The dust flags from both MERRA-2 and CAMS satellite-derived datasets indicate higher than usual (compared to the entire study region and period) concentrations of dust at that pixel using various thresholds (50th, 75th and 95th percentiles). Temperature Temperature flags are set to show days on which the mean daily temperature is below a certain threshold (12°C, 15°C and 18°C). This is a proxy for likely wood heater smoke as heater usage is more probable in colder weather. Wood heater usage is also dependent on other factors such as housing structure and density, climatic conditions and socioeconomic status. Statistical thresholds The statistical flags indicate an exceptional level of estimated PM2.5 concentration in comparison with the full timeseries for that particular pixel. It is important to note that these two flags differ in what is considered exceptional. The statistical flag smoke_p95_v1_3 is the 95th percentile of estimated total PM2.5 at that pixel over the whole study period, and thus is a single absolute value PM2.5 threshold regardless of timepoint (Fig. 9.1 (a)). Figure 9.1: Comparison of statistical flags using thresholds of the 95th percentile of total PM2.5 (top) and 2 standard deviations of the remainder (bottom) for Melbourne (Victoria). In contrast, the statistical flag trimmed_smoke_2SD_v1_3 indicates where the remainder has exceeded 2 standard deviations of the remainder at that location over the study period. Remembering that the STL components sum to the total PM2.5 (see Figure 8.1 and 8.3 in the previous section), the remainder in Figure 9.1 (b) is the difference between total PM2.5, and the seasonal and trend components combined (grey and blue lines, respectively). The threshold for trimmed_smoke_2SD_v1_3 (remainder &gt; 2SD of the remainder) is therefore equivalent to the total PM2.5 being greater than the seasonal + trend + 2SD of the remainder. This takes into account the seasonal fluctuations of that location and is intended to flag a pixel when the total PM2.5 is unusually high given the temporal patterns of that location. For the example in Figure 9.1, slightly higher PM2.5 levels (seasonal + trend) are expected in the summer months whereas levels in colder months (June to September) remain low. Note one day in summer (January) is flagged by smoke_p95_v1_3 as it is unusually high compared to the long-term average. However, this day is not flagged by trimmed_smoke_2SD_v1_3 since the concentration is not high considering the levels typically experienced at this point in the year. The reverse situation can be observed in July. Multiple days are flagged by trimmed_smoke_2SD_v1_3 but not by smoke_p95_v1_3 as the PM2.5 concentration is lower than long-term average but higher than typical of winter days at this location. "],["cart-model.html", "10 CART model", " 10 CART model Classification and regression tree (CART) model trained using a set of known bushfire events. TODO "],["identifying-extreme-pm2.5-events.html", "11 Identifying extreme PM2.5 events", " 11 Identifying extreme PM2.5 events As described in dataset paper. TODO "],["exceptional-pm2.5-events.html", "12 Exceptional PM2.5 events", " 12 Exceptional PM2.5 events HIA Study on mortality and exceptional PM2.5 events. Mortality burden attributable to exceptional PM2.5 air pollution events in Australian cities: A health impact assessment "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
